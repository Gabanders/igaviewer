<link rel="import" href="polymer/polymer/polymer-element.html">

<dom-module id="ig-panel">
  <template>
    <style>
      :host
      {
        position: fixed;
        display: flex;
        flex-direction: column;
        top: 0;
        width: 100%;
        height: 100%;
        font-size: 0;
        background-color: rgba(20, 21, 24, 0.6);
        z-index: 11;
        transition: opacity .2s,z-index 0s;
      }

      :host(.hidden)
      {
        z-index: -10;
        opacity: 0;
        transition-delay: 0s,.2s;
      }

      :host(.hidden) #thumbs
      {
        opacity: 0;
        transform: translateY(50px);
      }

      #thumbs
      {
        display: inline-block;
        max-width: 1020px;
        padding: 30px 0 20px 14px;
        text-align: left;
        opacity: 1;
        transition: opacity .2s,transform .2s;
      }

      #thumbs a
      {
        display: inline-block;
        width: 47%;
        margin: 0 10px 10px 0;
        border-radius: 2px;
        overflow: hidden;
        box-sizing: border-box;
      }

      @media (min-width: 465px)
      {
        #thumbs a
        {
          width: 31%;
        }

        #thumbs
        {
          padding-left: 24px;
        }
      }

      @media (min-width: 1000px)
      {
        #thumbs a
        {
          width: 18%;
        }

        #thumbs
        {
          padding-left: 50px;
        }
      }

      #thumbs a.selected
      {
        border: 3px solid white;
      }

      #thumbs img
      {
        width: 100%;
      }

      .thumb-holder
      {
        width: 100%;
        height: 100%;
        overflow: auto;
      }

      .action-bar
      {
        display: inline-block;
        width: 100%;
        height: 85px;
        box-sizing: border-box;
        padding-top: 5px;
      }

      .action-bar .bar-container
      {
        display: inline-block;
        border-top: 1px solid white;
        width: 90%;
        height: 100%;
      }

      .bar-container .bar-button
      {
        display: inline-block;
        width: 50%;
        height: 100%;
        line-height: 80px;
        color: white;
        font-family: "Open Sans";
        font-size: 20px;
        user-select: none;
        cursor: pointer;
        transition: background-color .2s;
      }

      .bar-button:hover
      {
        background-color: rgba(255,255,255,.1);
      }

      .bar-button:active
      {
        background-color: rgba(255,255,255,.3);
      }
    </style>

    <div class="thumb-holder">
      <div id="thumbs">

      </div>
    </div>

    <div class="action-bar">
      <div class="bar-container">
        <div class="bar-button" on-click="panelHide">✖</div>
        <div class="bar-button">・・・</div>
      </div>
    </div>

  </template>

  <script>
    class igPanel extends Polymer.Element
    {
      static get is()
      {
        return "ig-panel";
      }

      /*
        element-array thumblinks: array of thumblinks (<a> elements)
        element currentTl: current thumblink, <a> element currently selected
      */
      static get properties()
      {
        return {

        };
      }

      //load non-thumbnail img array
      loadNTImgs(imgs)
      {
        //creating thumblinks
        for (var x=0,l=imgs.length;x<l;x++)
        {
          if (imgs[x].slice(-1)=="v")
          {
            this.$.thumbs.insertAdjacentHTML("beforeend",
              `<a href="${x}"><img src="${imgs[x].slice(0,-5)+"b.jpg"}"></a>`
            );
          }

          else
          {
            this.$.thumbs.insertAdjacentHTML("beforeend",
              `<a href="${x}"><img src="${imgs[x].slice(0,-4)+"b.jpg"}"></a>`
            );
          }
        }

        //selecting/adding events to thumblinks
        this.thumblinks=this.$.thumbs.querySelectorAll("a");
        for (var x=0,l=this.thumblinks.length;x<l;x++)
        {
          this.thumblinks[x].addEventListener("click",(e)=>{
            e.preventDefault();

            igview.viewImg(parseInt(e.currentTarget.getAttribute("href")));
            this.classList.add("hidden");
          });
        }
      }

      //give index to be jumped to
      jumpTo(img)
      {
        if (this.currentTl)
        {
          this.currentTl.classList.remove("selected");
        }

        this.currentTl=this.thumblinks[img];
        this.currentTl.classList.add("selected");
        this.currentTl.scrollIntoView();
      }

      panelHide(e)
      {
        this.classList.add("hidden");
      }
    }

    customElements.define(igPanel.is,igPanel);
  </script>
</dom-module>